import{r as v,d as Y,e as se,_ as oe,b as k,w as H,c as r,o as l,a as e,g as c,t as a,k as C,z as ne,m as T,F,l as G,C as q,i as W,J as Z,v as le,I as re,f as ae}from"./main-CKplmvXD.js";import{_ as ie}from"./StatusBadge-BM6RTk6K.js";const M={mobile:640,tablet:1024,desktop:1280},de={xs:{min:0,max:374},sm:{min:375,max:639},md:{min:640,max:767},lg:{min:768,max:1023},xl:{min:1024,max:1279},"2xl":{min:1280,max:1535},"3xl":{min:1536,max:9999}};function ue(t=window.innerWidth){return t<M.mobile?"mobile":t<M.tablet?"tablet":t<M.desktop?"desktop":"wide"}function ce(t=window.innerWidth){for(const[m,d]of Object.entries(de))if(t>=d.min&&t<=d.max)return m;return"3xl"}function K(t=window.innerWidth){return t<M.mobile}function Q(t=window.innerWidth){return t>=M.mobile&&t<M.tablet}function X(t=window.innerWidth){return t>=M.tablet}function ge(t,m=window.innerWidth){return K(m)&&t.mobile!==void 0?t.mobile:Q(m)&&t.tablet!==void 0?t.tablet:X(m)&&t.desktop!==void 0?t.desktop:t.desktop||t.tablet||t.mobile}function ve(){const t=v(0),m=v(0),d=v("mobile"),w=v("sm"),x=()=>{t.value=window.innerWidth,m.value=window.innerHeight,d.value=ue(t.value),w.value=ce(t.value)};return Y(()=>{x(),window.addEventListener("resize",x)}),se(()=>{window.removeEventListener("resize",x)}),{width:t,height:m,breakpoint:d,screenSize:w,isMobile:()=>K(t.value),isTablet:()=>Q(t.value),isDesktop:()=>X(t.value),getResponsiveValue:f=>ge(f,t.value)}}const me={productCard:{mobile:"w-16 h-16",tablet:"w-20 h-20",desktop:"w-24 h-24"}},xe={cardPadding:{mobile:"p-4",tablet:"p-6",desktop:"p-8"}},be={title:{mobile:"text-base",tablet:"text-lg",desktop:"text-xl"}},fe={class:"bg-white rounded-lg border border-gray-200 shadow-sm hover:shadow-md transition-shadow duration-200"},ye={class:"flex flex-col sm:flex-row p-4 sm:p-6 gap-4"},pe={class:"flex-shrink-0"},we={class:"w-16 h-16 sm:w-20 sm:h-20 rounded-lg overflow-hidden bg-gray-100"},he=["src","alt"],ke={key:1,class:"w-full h-full flex items-center justify-center"},Ce={class:"flex-1 min-w-0"},_e={class:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3"},$e={class:"flex-1 min-w-0"},Se={class:"text-base sm:text-lg font-medium text-gray-900 truncate"},Me={class:"text-sm text-gray-500 mt-1"},De={key:0,class:"mt-2"},Ie={class:"text-sm text-gray-600"},Pe={key:0,class:"text-xs text-gray-500"},Ee={class:"flex flex-col sm:items-end gap-2"},Te={class:"text-lg sm:text-xl font-semibold text-gray-900"},Ne={class:"mt-4 grid grid-cols-2 sm:grid-cols-4 gap-4"},Ve={class:"text-center sm:text-left"},ze={key:0,class:"text-center sm:text-left"},je={class:"text-sm font-medium text-blue-600"},Oe={key:1,class:"text-center sm:text-left"},Le={class:"text-sm font-medium text-orange-600"},Be={key:2,class:"text-center sm:text-left"},Re={key:0,class:"mt-4 grid grid-cols-2 gap-4 text-xs text-gray-500"},Ae={class:"mt-4 flex flex-wrap gap-2"},Ue={key:0,class:"border-t border-gray-200 bg-gray-50 p-4"},We={class:"mb-3"},He={class:"flex space-x-1","aria-label":"Debug Tabs"},Je=["onClick"],qe={class:"bg-white rounded border p-3 max-h-60 overflow-y-auto"},Fe={key:0,class:"space-y-2"},Ge={class:"grid grid-cols-2 gap-4 text-xs"},Ye={class:"ml-1 text-gray-600"},Ze={class:"ml-1 text-gray-600"},Ke={class:"ml-1 text-gray-600"},Qe={class:"mt-3"},Xe={class:"mt-1 text-xs text-gray-600"},et={class:"inline-block mr-3"},tt={class:"inline-block mr-3"},st={class:"inline-block"},ot={key:1,class:"space-y-2"},nt={class:"text-xs"},lt={class:"mt-1 bg-gray-50 p-2 rounded text-xs overflow-x-auto"},rt={class:"text-xs"},at={class:"mt-1 bg-gray-50 p-2 rounded text-xs overflow-x-auto"},it={key:2,class:"space-y-2"},dt={class:"text-xs"},ut={class:"mt-1 bg-gray-50 p-2 rounded text-xs overflow-x-auto"},ct={class:"text-xs"},gt={class:"mt-1 bg-gray-50 p-2 rounded max-h-32 overflow-y-auto"},vt={class:"text-blue-600"},mt={class:"text-gray-600 ml-2"},xt={class:"text-gray-500 ml-2"},bt={key:0,class:"text-gray-500 text-xs"},ft={key:3,class:"space-y-2"},yt={class:"text-xs"},pt={class:"mt-1 bg-gray-50 p-2 rounded"},wt={class:"text-xs"},ht={class:"mt-1 bg-yellow-50 p-2 rounded border border-yellow-200"},kt={class:"space-y-1"},Ct={key:0,class:"text-yellow-700"},_t={key:1,class:"text-red-700"},$t={key:2,class:"text-orange-700"},St={key:3,class:"text-yellow-700"},Mt={key:4,class:"text-blue-700"},Dt={key:5,class:"text-red-700"},It={key:4,class:"space-y-2"},Pt={class:"text-xs"},Et={class:"mt-1 bg-gray-50 p-2 rounded"},Tt={class:"text-xs"},Nt={class:"mt-1 bg-blue-50 p-2 rounded border border-blue-200"},Vt={class:"space-y-1 text-blue-700"},zt={key:0},jt={key:1},Ot={class:"mt-3 flex items-center justify-between"},Lt={class:"text-xs text-gray-500"},Bt={__name:"ProductCard",props:{product:{type:Object,required:!0,validator:t=>t&&typeof t.id<"u"&&t.name},viewMode:{type:String,required:!0,validator:t=>["frontend","backend"].includes(t)},showOrderCount:{type:Boolean,default:!0},showDebugInfo:{type:Boolean,default:!1},allowEdit:{type:Boolean,default:!1}},emits:["edit","view-details","debug"],setup(t,{emit:m}){const d=t,w=m,x=v(!1),f=v("basic"),g=v([]),h=v(""),b=v(0),S=v(""),D=v(""),N=v(!1),{isMobile:O,isTablet:L,isDesktop:B,getResponsiveValue:V}=ve(),R=[{key:"basic",label:"基本"},{key:"product",label:"商品"},{key:"props",label:"Props"},{key:"api",label:"API"},{key:"performance",label:"效能"}],z=()=>{h.value=new Date().toLocaleTimeString("zh-TW")},y=(i,s)=>{g.value.unshift({timestamp:new Date().toLocaleTimeString("zh-TW"),type:i,detail:s}),g.value.length>50&&(g.value=g.value.slice(0,50))},_=k(()=>{b.value++;const i=d.product.inventory||0,s=d.product.reservedCount||0;return Math.max(0,i-s)});k(()=>V(me.productCard)),k(()=>V(xe.cardPadding)),k(()=>V(be.title));const A=i=>i?`NT$ ${Number(i).toLocaleString()}`:"NT$ 0",U=i=>i?new Date(i).toLocaleString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-",I=i=>{const s=Number(i)||0;return s===0?"text-red-600":s<10?"text-orange-600":"text-green-600"},n=i=>{const s=Number(i)||0;return s===0?"text-red-600":s<5?"text-orange-600":"text-green-600"},o=()=>{y("edit",`編輯商品 ID: ${d.product.id}`),w("edit",d.product)},u=()=>{y("view-details",`查看商品詳情 ID: ${d.product.id}`),w("view-details",d.product)},P=()=>{x.value=!x.value,y("debug-toggle",`除錯面板${x.value?"開啟":"關閉"}`),w("debug",{product:d.product,viewMode:d.viewMode,debugVisible:x.value,responsive:{isMobile:O(),isTablet:L(),isDesktop:B()},performance:{renderTime:h.value,computedCount:b.value,eventCount:g.value.length}})},E=async()=>{const i={product:d.product,viewMode:d.viewMode,computedValues:{availableStock:_.value,inventoryColor:I(d.product.inventory),availableColor:n(_.value)},performance:{renderTime:h.value,computedCount:b.value,eventCount:g.value.length},events:g.value.slice(0,10)};try{await navigator.clipboard.writeText(JSON.stringify(i,null,2)),y("copy","除錯資訊已複製到剪貼簿")}catch(s){y("copy-error",`複製失敗: ${s.message}`)}},j=()=>{const i={timestamp:new Date().toISOString(),product:d.product,events:g.value,performance:{renderTime:h.value,computedCount:b.value}},s=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),p=URL.createObjectURL(s),$=document.createElement("a");$.href=p,$.download=`product-${d.product.id}-debug-${Date.now()}.json`,document.body.appendChild($),$.click(),document.body.removeChild($),URL.revokeObjectURL(p),y("export","除錯日誌已匯出")},J=()=>{const i=g.value.length;g.value=[],y("clear",`已清除 ${i} 個事件記錄`)},ee=()=>{y("test","手動觸發的測試事件")},te=()=>{if(performance.memory){const i=Math.round(performance.memory.usedJSHeapSize/1024/1024),s=Math.round(performance.memory.totalJSHeapSize/1024/1024);return`${i}MB / ${s}MB`}return"不支援"};return Y(()=>{z(),y("mounted","組件已掛載")}),H(()=>d.product,(i,s)=>{s&&i.id!==s.id&&y("product-change",`商品從 ${s.id} 變更為 ${i.id}`),z()},{deep:!0}),H(()=>d.viewMode,(i,s)=>{s&&y("viewmode-change",`顯示模式從 ${s} 變更為 ${i}`)}),(i,s)=>(l(),r("div",fe,[e("div",ye,[e("div",pe,[e("div",we,[t.product.image?(l(),r("img",{key:0,src:t.product.image,alt:t.product.name,class:"w-full h-full object-cover"},null,8,he)):(l(),r("div",ke,[...s[0]||(s[0]=[e("svg",{class:"w-8 h-8 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)])]))])]),e("div",Ce,[e("div",_e,[e("div",$e,[e("h3",Se,a(t.product.name),1),e("p",Me," #"+a(t.product.id),1),t.viewMode==="backend"&&t.product.sellerName?(l(),r("div",De,[e("p",Ie,[s[1]||(s[1]=e("span",{class:"font-medium"},"賣家：",-1)),C(a(t.product.sellerName),1)]),t.product.sellerId?(l(),r("p",Pe," ID: "+a(t.product.sellerId),1)):c("",!0)])):c("",!0)]),e("div",Ee,[e("div",Te,a(A(t.product.price)),1),ne(ie,{status:t.product.status},null,8,["status"])])]),e("div",Ne,[e("div",Ve,[s[2]||(s[2]=e("p",{class:"text-xs text-gray-500"},"可用庫存",-1)),e("p",{class:T(["text-sm font-medium",I(t.product.inventory)])},a(t.product.inventory||0),3)]),t.showOrderCount?(l(),r("div",ze,[s[3]||(s[3]=e("p",{class:"text-xs text-gray-500"},"下單數量",-1)),e("p",je,a(t.product.orderCount||0),1)])):c("",!0),t.viewMode==="backend"?(l(),r("div",Oe,[s[4]||(s[4]=e("p",{class:"text-xs text-gray-500"},"預留庫存",-1)),e("p",Le,a(t.product.reservedCount||0),1)])):c("",!0),t.viewMode==="backend"?(l(),r("div",Be,[s[5]||(s[5]=e("p",{class:"text-xs text-gray-500"},"實際可售",-1)),e("p",{class:T(["text-sm font-medium",n(_.value)])},a(_.value),3)])):c("",!0)]),t.viewMode==="backend"?(l(),r("div",Re,[e("div",null,[s[6]||(s[6]=e("span",{class:"font-medium"},"建立：",-1)),C(a(U(t.product.createdAt)),1)]),e("div",null,[s[7]||(s[7]=e("span",{class:"font-medium"},"更新：",-1)),C(a(U(t.product.updatedAt)),1)])])):c("",!0),e("div",Ae,[t.allowEdit?(l(),r("button",{key:0,onClick:o,class:"inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},[...s[8]||(s[8]=[e("svg",{class:"w-4 h-4 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),C(" 編輯 ",-1)])])):c("",!0),t.viewMode==="backend"?(l(),r("button",{key:1,onClick:u,class:"inline-flex items-center px-3 py-1.5 border border-blue-300 shadow-sm text-sm font-medium rounded-md text-blue-700 bg-blue-50 hover:bg-blue-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},[...s[9]||(s[9]=[e("svg",{class:"w-4 h-4 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1),C(" 詳情 ",-1)])])):c("",!0),t.showDebugInfo?(l(),r("button",{key:2,onClick:P,class:"inline-flex items-center px-3 py-1.5 border border-yellow-300 shadow-sm text-sm font-medium rounded-md text-yellow-700 bg-yellow-50 hover:bg-yellow-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500"},[...s[10]||(s[10]=[e("svg",{class:"w-4 h-4 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),C(" 除錯 ",-1)])])):c("",!0)])])]),t.showDebugInfo&&x.value?(l(),r("div",Ue,[e("div",{class:"flex items-center justify-between mb-3"},[s[11]||(s[11]=e("h4",{class:"text-sm font-medium text-gray-900"},"除錯資訊面板",-1)),e("div",{class:"flex items-center gap-2"},[e("button",{onClick:E,class:"text-xs px-2 py-1 bg-blue-100 text-blue-700 rounded hover:bg-blue-200"}," 複製資訊 "),e("button",{onClick:j,class:"text-xs px-2 py-1 bg-green-100 text-green-700 rounded hover:bg-green-200"}," 匯出日誌 ")])]),e("div",We,[e("nav",He,[(l(),r(F,null,G(R,p=>e("button",{key:p.key,onClick:$=>f.value=p.key,class:T([f.value===p.key?"bg-white text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700","px-3 py-1.5 text-xs font-medium rounded-md transition-colors"])},a(p.label),11,Je)),64))])]),e("div",qe,[f.value==="basic"?(l(),r("div",Fe,[e("div",Ge,[s[15]||(s[15]=e("div",null,[e("strong",{class:"text-gray-700"},"組件:"),e("span",{class:"ml-1 text-gray-600"},"ProductCard.vue")],-1)),e("div",null,[s[12]||(s[12]=e("strong",{class:"text-gray-700"},"顯示模式:",-1)),e("span",Ye,a(t.viewMode),1)]),e("div",null,[s[13]||(s[13]=e("strong",{class:"text-gray-700"},"商品 ID:",-1)),e("span",Ze,a(t.product.id),1)]),e("div",null,[s[14]||(s[14]=e("strong",{class:"text-gray-700"},"渲染時間:",-1)),e("span",Ke,a(h.value),1)])]),e("div",Qe,[s[16]||(s[16]=e("strong",{class:"text-gray-700 text-xs"},"響應式狀態:",-1)),e("div",Xe,[e("span",et,"手機: "+a(q(O)()?"是":"否"),1),e("span",tt,"平板: "+a(q(L)()?"是":"否"),1),e("span",st,"桌面: "+a(q(B)()?"是":"否"),1)])])])):c("",!0),f.value==="product"?(l(),r("div",ot,[e("div",nt,[s[17]||(s[17]=e("strong",{class:"text-gray-700"},"完整商品資料:",-1)),e("pre",lt,a(JSON.stringify(t.product,null,2)),1)]),e("div",rt,[s[18]||(s[18]=e("strong",{class:"text-gray-700"},"計算屬性:",-1)),e("pre",at,a(JSON.stringify({availableStock:_.value,inventoryColor:I(t.product.inventory),availableColor:n(_.value),formattedPrice:A(t.product.price)},null,2)),1)])])):c("",!0),f.value==="props"?(l(),r("div",it,[e("div",dt,[s[19]||(s[19]=e("strong",{class:"text-gray-700"},"Props 狀態:",-1)),e("pre",ut,a(JSON.stringify({viewMode:t.viewMode,showOrderCount:t.showOrderCount,allowEdit:t.allowEdit,showDebugInfo:t.showDebugInfo},null,2)),1)]),e("div",ct,[s[20]||(s[20]=e("strong",{class:"text-gray-700"},"事件歷史:",-1)),e("div",gt,[(l(!0),r(F,null,G(g.value,(p,$)=>(l(),r("div",{key:$,class:"text-xs mb-1"},[e("span",vt,a(p.timestamp),1),e("span",mt,a(p.type),1),e("span",xt,a(p.detail),1)]))),128)),g.value.length===0?(l(),r("div",bt,"尚無事件記錄")):c("",!0)])])])):c("",!0),f.value==="api"?(l(),r("div",ft,[e("div",yt,[s[21]||(s[21]=e("strong",{class:"text-gray-700"},"API 狀態:",-1)),e("div",pt,[e("div",null,"最後更新: "+a(S.value||"未知"),1),e("div",null,"資料來源: "+a(D.value||"未知"),1),e("div",null,"載入狀態: "+a(N.value?"載入中":"已完成"),1)])]),e("div",wt,[s[22]||(s[22]=e("strong",{class:"text-gray-700"},"除錯建議:",-1)),e("div",ht,[e("ul",kt,[t.product.image?c("",!0):(l(),r("li",Ct,"⚠️ 商品缺少圖片")),t.product.inventory<=0?(l(),r("li",_t,"❌ 商品庫存為零")):c("",!0),t.product.inventory>0&&t.product.inventory<=5?(l(),r("li",$t,"⚠️ 商品庫存不足")):c("",!0),!t.product.sellerName&&t.viewMode==="backend"?(l(),r("li",St,"⚠️ 缺少賣家資訊")):c("",!0),g.value.length===0?(l(),r("li",Mt,"ℹ️ 尚未觸發任何事件")):c("",!0),t.product.orderCount>t.product.inventory?(l(),r("li",Dt,"❌ 下單數量超過庫存")):c("",!0)])])])])):c("",!0),f.value==="performance"?(l(),r("div",It,[e("div",Pt,[s[23]||(s[23]=e("strong",{class:"text-gray-700"},"效能指標:",-1)),e("div",Et,[e("div",null,"組件渲染時間: "+a(h.value),1),e("div",null,"響應式計算次數: "+a(b.value),1),e("div",null,"事件觸發次數: "+a(g.value.length),1),e("div",null,"記憶體使用: "+a(te()),1)])]),e("div",Tt,[s[26]||(s[26]=e("strong",{class:"text-gray-700"},"效能建議:",-1)),e("div",Nt,[e("ul",Vt,[b.value>10?(l(),r("li",zt,"⚠️ 響應式計算次數較多，考慮優化")):c("",!0),g.value.length>20?(l(),r("li",jt,"⚠️ 事件記錄過多，考慮清理")):c("",!0),s[24]||(s[24]=e("li",null,"✅ 使用 v-memo 優化大列表渲染",-1)),s[25]||(s[25]=e("li",null,"✅ 圖片使用 lazy loading",-1))])])])])):c("",!0)]),e("div",Ot,[e("div",{class:"flex items-center gap-2"},[e("button",{onClick:J,class:"text-xs px-2 py-1 bg-red-100 text-red-700 rounded hover:bg-red-200"}," 清除事件 "),e("button",{onClick:ee,class:"text-xs px-2 py-1 bg-purple-100 text-purple-700 rounded hover:bg-purple-200"}," 測試事件 ")]),e("div",Lt," 除錯模式 - "+a(new Date().toLocaleTimeString("zh-TW")),1)])])):c("",!0)]))}},Rt=oe(Bt,[["__scopeId","data-v-a1c84567"]]),At={class:"space-y-6 pt-2"},Ut={class:"bg-white shadow-sm rounded-xl border border-gray-200 px-6 py-4"},Wt={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},Ht={class:"flex space-x-1","aria-label":"Tabs"},Jt={class:"ml-2 py-0.5 px-2 rounded-full text-xs font-semibold bg-white border border-gray-200 text-gray-600"},qt={key:0,class:"ml-2 py-0.5 px-2 rounded-full text-xs font-semibold bg-white border border-green-100 text-green-600"},Ft={key:1,class:"ml-2 py-0.5 px-2 rounded-full text-xs font-medium bg-gray-100 text-gray-500"},Gt={key:0,class:"ml-2 py-0.5 px-2 rounded-full text-xs font-semibold bg-white border border-orange-100 text-orange-600"},Yt={key:1,class:"ml-2 py-0.5 px-2 rounded-full text-xs font-medium bg-gray-100 text-gray-500"},Zt={class:"flex items-center gap-4"},Kt={class:"flex items-center gap-2"},Qt={class:"relative w-full max-w-sm"},Xt={class:"flex items-center text-sm text-gray-600"},es={class:"bg-white shadow-sm rounded-lg border border-gray-200 p-6"},ts={key:0,class:"py-12 text-center text-gray-500"},ss={key:1,class:"py-12 text-center text-gray-500"},os={key:2,class:"space-y-4"},ns={class:"px-4 py-3 bg-white border-t border-gray-200 sm:px-6 flex flex-col sm:flex-row items-center justify-between gap-4"},ls={class:"flex items-center text-xs text-gray-500 gap-4"},rs={class:"flex items-center gap-2"},as={class:"flex items-center gap-3"},is={class:"relative z-0 inline-flex shadow-sm rounded-md"},ds=["disabled"],us=["disabled"],vs={__name:"ProductList",setup(t){const m=v([]),d=v(!0),w=v(null),x=v("all"),f=v(""),g=v("frontend"),h=v(!1),b=v(1),S=v(10),D=k(()=>{let n=m.value;if(x.value==="publish"?n=n.filter(o=>o.status==="publish"):x.value==="draft"&&(n=n.filter(o=>o.status==="draft")),f.value){const o=f.value.toLowerCase();n=n.filter(u=>u.name&&u.name.toLowerCase().includes(o)||u.id&&u.id.toString().includes(o))}return n}),N=k(()=>Math.ceil(D.value.length/S.value)||1),O=k(()=>{const n=(b.value-1)*S.value,o=n+S.value;return D.value.slice(n,o)}),L=()=>{b.value>1&&b.value--},B=()=>{b.value<N.value&&b.value++},V=k(()=>m.value.length),R=k(()=>m.value.filter(n=>n.status==="publish").length),z=k(()=>m.value.filter(n=>n.status==="draft").length);H([x,f],()=>{b.value=1});const y=n=>{console.log("編輯商品:",n)},_=n=>{console.log("查看商品詳情:",n)},A=n=>{console.log("商品除錯資訊:",n)},U=n=>({id:n.id,post_id:n.post_id,name:n.name||n.variation_title||"未命名商品",price:n.price||0,inventory:n.stock||n.inventory||0,orderCount:n.order_count||0,reservedCount:n.reserved_count||0,status:n.status||"draft",image:n.image||null,sellerId:n.seller_id||0,sellerName:n.seller_name||"",createdAt:n.created_at||new Date().toISOString(),updatedAt:n.updated_at||new Date().toISOString()}),I=async()=>{d.value=!0,w.value=null;try{const n=window.buygo_frontend||window.buygo_admin;if(!n||!n.api_url)throw new Error("API Config Missing");const o={"X-WP-Nonce":n.nonce,"Content-Type":"application/json"},u=new URLSearchParams({view_mode:g.value,status:"all"}),P=`${n.api_url}/products?${u.toString()}`,E=await fetch(P,{headers:o,credentials:"same-origin"});if(!E.ok){const J=await E.text();throw new Error(`API 請求失敗 (${E.status}): ${J}`)}const j=await E.json();if(j.success)m.value=j.data||[],console.log("成功載入商品:",m.value.length,"筆");else throw new Error(j.message||"載入商品失敗")}catch(n){w.value=n.message,console.error("載入商品失敗:",n);try{console.log("嘗試使用舊版 API...");const o=`${config.api_url}/stats/seller-products`,u=await fetch(o,{headers,credentials:"same-origin"});if(u.ok){const P=await u.json();P.success&&(m.value=P.data||[],console.log("使用舊版 API 成功載入商品:",m.value.length,"筆"),w.value=null)}}catch(o){console.error("舊版 API 也失敗:",o)}}finally{d.value=!1}};return Y(()=>{I()}),H(g,()=>{I()}),(n,o)=>(l(),r("div",At,[e("div",Ut,[e("div",Wt,[e("nav",Ht,[e("button",{onClick:o[0]||(o[0]=u=>x.value="all"),class:T([x.value==="all"?"bg-gray-100 text-gray-900":"text-gray-500 hover:text-gray-700 hover:bg-gray-50","px-3 py-2 font-medium text-sm rounded-md transition-colors flex items-center"])},[o[7]||(o[7]=C(" 全部 ",-1)),e("span",Jt,a(V.value),1)],2),e("button",{onClick:o[1]||(o[1]=u=>x.value="publish"),class:T([x.value==="publish"?"bg-green-50 text-green-700":"text-gray-500 hover:text-gray-700 hover:bg-gray-50","px-3 py-2 font-medium text-sm rounded-md transition-colors flex items-center"])},[o[8]||(o[8]=C(" 已發布 ",-1)),R.value>0?(l(),r("span",qt,a(R.value),1)):(l(),r("span",Ft,"0"))],2),e("button",{onClick:o[2]||(o[2]=u=>x.value="draft"),class:T([x.value==="draft"?"bg-orange-50 text-orange-700":"text-gray-500 hover:text-gray-700 hover:bg-gray-50","px-3 py-2 font-medium text-sm rounded-md transition-colors flex items-center"])},[o[9]||(o[9]=C(" 草稿 ",-1)),z.value>0?(l(),r("span",Gt,a(z.value),1)):(l(),r("span",Yt,"0"))],2)]),e("div",Zt,[e("div",Kt,[o[11]||(o[11]=e("label",{class:"text-sm text-gray-600"},"顯示模式：",-1)),W(e("select",{"onUpdate:modelValue":o[3]||(o[3]=u=>g.value=u),class:"text-sm border-gray-300 rounded-md focus:ring-gray-900 focus:border-gray-900"},[...o[10]||(o[10]=[e("option",{value:"frontend"},"前台模式",-1),e("option",{value:"backend"},"後台模式",-1)])],512),[[Z,g.value]])]),e("div",Qt,[o[12]||(o[12]=e("div",{class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},[e("svg",{class:"h-4 w-4 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),W(e("input",{type:"text","onUpdate:modelValue":o[4]||(o[4]=u=>f.value=u),class:"block w-full rounded-md border-gray-300 pl-10 focus:border-gray-900 focus:ring-gray-900 text-sm py-2 placeholder-gray-400 shadow-sm",placeholder:"搜尋商品名稱..."},null,512),[[le,f.value]])]),e("label",Xt,[W(e("input",{"onUpdate:modelValue":o[5]||(o[5]=u=>h.value=u),type:"checkbox",class:"mr-2 rounded border-gray-300 focus:ring-gray-900"},null,512),[[re,h.value]]),o[13]||(o[13]=C(" 除錯模式 ",-1))])])])]),e("div",es,[d.value&&m.value.length===0?(l(),r("div",ts,[...o[14]||(o[14]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 mx-auto mb-4"},null,-1),e("span",{class:"text-sm"},"載入中...",-1)])])):D.value.length===0&&!d.value?(l(),r("div",ss,[...o[15]||(o[15]=[e("svg",{class:"mx-auto h-12 w-12 text-gray-400 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2 2v-5m16 0h-2M4 13h2m0 0V9a2 2 0 012-2h2m0 0V6a2 2 0 012-2h2.586a1 1 0 01.707.293l2.414 2.414a1 1 0 01.293.707V9a2 2 0 01-2 2h-2m0 0v2a2 2 0 002 2h2a2 2 0 002-2v-2"})],-1),e("p",{class:"text-sm"},"尚無商品資料",-1),e("p",{class:"text-xs text-gray-400 mt-1"},"請先新增商品或調整篩選條件",-1)])])):(l(),r("div",os,[(l(!0),r(F,null,G(O.value,u=>(l(),ae(Rt,{key:u.id,product:U(u),viewMode:g.value,showOrderCount:!0,allowEdit:!0,showDebugInfo:h.value,onEdit:y,onViewDetails:_,onDebug:A},null,8,["product","viewMode","showDebugInfo"]))),128))])),e("div",ns,[e("div",ls,[e("span",null,"第 "+a(b.value)+" 頁，共 "+a(N.value)+" 頁",1),e("div",rs,[o[17]||(o[17]=e("span",null,"每頁",-1)),W(e("select",{"onUpdate:modelValue":o[6]||(o[6]=u=>S.value=u),class:"form-select text-xs border-gray-300 rounded focus:ring-black focus:border-black py-1 pl-2 pr-6 border"},[...o[16]||(o[16]=[e("option",{value:10},"10",-1),e("option",{value:20},"20",-1),e("option",{value:50},"50",-1),e("option",{value:100},"100",-1)])],512),[[Z,S.value]]),o[18]||(o[18]=e("span",null,"筆",-1))]),e("span",null,"總計 "+a(D.value.length)+" 筆",1)]),e("div",as,[e("div",is,[e("button",{type:"button",onClick:L,disabled:b.value===1,class:"relative inline-flex items-center px-4 py-1.5 rounded-l-md border border-gray-300 bg-white text-xs font-medium text-gray-700 hover:bg-gray-50 focus:z-10 focus:outline-none focus:ring-1 focus:ring-black focus:border-black disabled:opacity-50 disabled:cursor-not-allowed"}," 上一頁 ",8,ds),e("button",{type:"button",onClick:B,disabled:b.value===N.value,class:"relative -ml-px inline-flex items-center px-4 py-1.5 rounded-r-md border border-gray-300 bg-white text-xs font-medium text-gray-700 hover:bg-gray-50 focus:z-10 focus:outline-none focus:ring-1 focus:ring-black focus:border-black disabled:opacity-50 disabled:cursor-not-allowed"}," 下一頁 ",8,us)])])])])]))}};export{vs as default};
